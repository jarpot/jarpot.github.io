<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    市<select name="" id="shi"></select>
    区<select name="" id="qu"></select>

    <script>
        var addObj;
        //(function () {
        //1.创建ajax对象
        var ajax_obj = new XMLHttpRequest();
        //2.建立连接
        ajax_obj.open("get", "./address.json", true);
        //3.
        ajax_obj.send();
        //4.
        ajax_obj.onreadystatechange = function () {
            //console.log(ajax_obj.readyState);请求过程中的所有的状态码的变化  0 1 2 3 4
            if (ajax_obj.readyState == 4) {
                if (ajax_obj.status == 200) {
                    //把从json文件中读取到的数据 赋值给addObj
                    addObj = JSON.parse(ajax_obj.responseText);
                    //console.log(addObj);
                    var val = Object.values(addObj);
                    console.log(val);
                    //1.取出json对象中所有的 key 
                    // Object.keys();  可以直接取出 json对象中所有的key值
                    shiEle = document.getElementById("shi");
                    quEle = document.getElementById("qu");
                    //window.onload = function () {

                    var keyArr = Object.keys(addObj);
                    for (var i in keyArr) {
                        //创建
                        var opEle = document.createElement("option");
                        //美化
                        opEle.innerText = keyArr[i];
                        //添加
                        shiEle.appendChild(opEle);
                    }

                    var quArr = addObj[keyArr[0]];
                    for (var i in quArr) {
                        //创建
                        var opEle = document.createElement("option");
                        //美化
                        opEle.innerText = quArr[i];
                        //添加
                        quEle.appendChild(opEle);
                    }
                   
                }
            }
        }

        document.getElementById("shi").onchange = function () {
            //此时  this.value就是我们需要的 市 的值 
            // addObj[this.value] 这个就是我们需要的区的数组
            //console.log( addObj[this.value]);
            var quArr = addObj[this.value];
            //在添加区之前  需要先把老的 内容给清空掉
            quEle.innerHTML = "";
            //干掉老的内容后，添加了新的内容(区)
            for (var i in quArr) {
                //创建
                var opEle = document.createElement("option");
                //美化
                opEle.innerText = quArr[i];
                //添加
                quEle.appendChild(opEle);
            }
        }
    </script>
</body>

</html>