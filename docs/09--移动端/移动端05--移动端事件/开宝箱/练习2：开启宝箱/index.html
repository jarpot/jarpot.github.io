<!DOCTYPE HTML>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0,user-scalable=no">
    <link rel="stylesheet" href="css/global.css">
    <link rel="stylesheet" href="css/open.css">
    <title>开启宝箱</title>
</head>

<body ontouchstart="" class="open-body">
    <div class="wrapper">
        <div class="bg rotate"></div>
        <div class="open-has ">
            <h3 class="title-close"><span class="user">开心果</span>给你发了一个宝箱</h3>
            <h3 class="title-open">恭喜你，</br>成功领取<span class="user">开心果</span>发的全民飞机大战宝箱</h3>
            <div class="mod-chest">
                <div class="chest-close show ">
                    <div class="gift"></div>
                    <div class="tips">
                        <i class="arrow"></i>
                    </div>
                </div>
                <div class="chest-open ">
                    <div class="mod-chest-cont open-cont">
                        <div class="content">
                            <div class="gift">
                                <div class="icon"><img src="img/chest-icon-zuan.png"></div> x 1000
                            </div>
                            <div class="func">
                                <button class="chest-btn">查看详情并提取</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script type="text/javascript" src="js/touch-0.2.14.min.js"></script>
    <script type="text/javascript">
    var open = document.querySelector(".chest-close");
    var chestopen = document.querySelector(".chest-open");
    var openhas = document.querySelector(".open-has");

    // 检查是否存在类 参数为 对象名称 和 类名
    function hasClass(obj, cls) {
        return obj.className.match(new RegExp("(\\s|^)" + cls + "(\\s|$)"));
    }
    // 添加类
    function addClass(obj, cls) {
        if (!this.hasClass(obj, cls)) {
            obj.className += " " + cls;
        }
    }
    // 删除类
    function removeClass(obj, cls) {
        if (hasClass(obj, cls)) {
            var reg = new RegExp("(\\s|^)" + cls + "(\\s|$)");
            obj.className = obj.className.replace(reg, "");
        }
    }
    // 调用touchjs库的tap方法
    touch.on(open, 'tap', function(ev) {

        addClass(this, "shake")

        this.addEventListener("webkitAnimationEnd", function() {
            addClass(openhas, "opened");
            setTimeout(function() {
                removeClass(open, "show");
                addClass(chestopen, "show");
            }, 200)

        }, false);

    });
    
    </script>
</body>

</html>